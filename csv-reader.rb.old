require 'csv'

# Values for the strings from the csv file
rank_values = {
  "E1" => 3,
  "E2" => 22,
  "E3" => 23,
  "E4" => 24,
  "E5" => 25,
  "E6" => 26,
  "E7" => 27,
  "E8" => 28,
  "E9" => 29,
  "W1" => 16,
  "W2" => 31,
  "W3" => 32,
  "W4" => 33,
  "W5" => 34,
  "O1" => 13,
  "O2" => 5,
  "O3" => 6,
  "O4" => 7,
  "O5" => 8,
  "O6" => 9,
  "O7" => 10,
  "O8" => 12,
  "O9" => 11,
  "010" => 35,
  "Civilian" => 37
}

branch_values = {
  nil => 0,
  "Unspecified" => 0,
  "Army" => 1,
  "Navy" => 2,
  "Air Force" => 3,
  "Marine Corps" => 4,
  "Coast Guard" => 5,
  "Army Reserve" => 6,
  "Navy Reserve" => 7,
  "Air Force Reserve" => 8,
  "Marine Corps Reserve" => 9,
  "Army National Guard" => 10,
  "Coast Guard Reserve" => 12,
  "Air National Guard" => 13,
  "Other" => 14
}

clearance_values = {
  nil => 0,
  "Unspecified" => 0,
  "Secret" => 1,
  "Top Secret" => 2,
  "None" => 3
}

education_values = {
  nil => 0,
  "Unspecified" => 0,
  "High School or GED" => 1,
  "Associates Degree" => 3,
  "Bachelors Degree" => 4,
  "Masters Degree" => 4,
  "PhD" => 4
}

# Object to store all of the information for each applicant
class Applicant

   attr_reader :first_name, :last_name, :email, :date_created, :registered, :date_registration_updated, :attended, :peer_group, :job_id, :job_alias, :job_variant, :street_address, :city, :state_province, :zipcode, :age, :gender, :mil_branch, :mil_rank, :primary_mos, :mos_title, :relocate, :date_available, :education_level, :experience, :clearance, :polygraph, :resume, :profile_pic

  def initialize(first_name, last_name, email, date_created, registered, date_registration_updated, attended, peer_group, job_id, job_alias, job_variant, street_address, city, state_province, zipcode, age, gender, mil_branch, mil_rank, primary_mos, mos_title, relocate, date_available, education_level, experience, clearance, polygraph, resume, profile_pic)
    @first_name = first_name # check
    @last_name = last_name #check
    @email = email #check
    @date_created = date_created
    @registered = registered
    @date_registration_updated = date_registration_updated
    @attended = attended
    @peer_group = peer_group
    @job_id = job_id
    @job_alias = job_alias
    @job_variant = job_variant
    @street_address = street_address #check
    @city = city # check
    @state_province = state_province #check
    @zipcode = zipcode #check
    @age = age
    @gender = gender
    @mil_branch = mil_branch #check
    @mil_rank = mil_rank #check
    @primary_mos = primary_mos
    @mos_title = mos_title
    @relocate = relocate #check
    @date_available = date_available #check
    @education_level = education_level #check
    @experience = experience
    @clearance = clearance #check
    @polygraph = polygraph
    @resume = resume
    @profile_pic = profile_pic
  end

  def create_values(val)
    val ? "\"#{val}\"" : ""
  end

  def create_file_string
    # "#{construct_csv(row[0])}, #{row[1]}, #{row[11]}, #{row[12]}, #{row[13]}, United States, #{row[14]}, phone not available, #{row[2]}, , , , , , #{rank_values[row[17]]}, #{rank_values[row[18]]}, #{clearance_values[row[25]]}, #{education_values[row[23]]}, #{row[21]}, #{row[22]}"
    "#{create_values(@first_name)},#{create_values(@last_name)},"
# first_name, last_name, street_address, city, state_province, country, zip, phone, email, job objective, company, first_year, MISC, unknown, mil_rank (required, mil_branch(required), clearance (require), education (required), relocate (required), available (required)
  end

end


# Store all of the applicant objects
applicant_array = []

# Go throught every row of the csv file
CSV.foreach("../corporate-gray-moaa-6-20141211-204645.csv") do |row|

  # Store every column value of a row in an Application instance
  app = Applicant.new(
    row[0], # First name
    row[1], # Last name
    row[2], # Email
    row[3], # Date Created
    row[4], # Registered
    row[5], # Date Registration Last Updated
    row[6], # Attended
    row[7], # Peer Group
    row[8], # Job Id
    row[9], # Job Alias
    row[10], # Job Variant
    row[11], # Street Address
    row[12], # City
    row[13], # State Province
    row[14], # Zipcode
    row[15], # Age
    row[16], # Gender
    branch_values[row[17]], # Military Branch
    rank_values[row[18]], # Military Rank
    row[19], # Primary MOS
    row[20], # MOS Title
    row[21], # Willing to Relocate
    row[22], # Date Available
    education_values[row[23]], # Education Level
    row[24], # Experience
    clearance_values[row[25]], # Clearance
    row[26], # Polygraph
    row[27], # Resume
    row[28] # Profile Picture
  )
#  puts row[21] ? row[21].downcase : ""
  # Add the new Application instance to the applicant_array 
  applicant_array << app
end

# first_name, last_name, street_address, city, state_province, country, zip, phone, email, job objective, company, first_year, MISC, unknown, mil_rank (required, mil_branch(required), clearance (require), education (required), relocate (required), available (required)

